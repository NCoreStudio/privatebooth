<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>個別ブース予約管理ツール</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <!-- ヘッダー -->
        <header class="header">
            <div class="header-inner">
                <!-- 左：日付選択＋凡例 -->
                <div class="header-left">
                    <div class="date-selector">
                        <label for="dateSelect">日付：</label>
                        <input type="date" id="dateSelect">
                        <span class="date-weekday" id="dateWeekday"></span>
                        <button class="date-nav-btn" id="prevDateBtn">←</button>
                        <button class="date-nav-btn" id="nextDateBtn">→</button>
                    </div>
                    <div class="legend">
                        <div class="legend-item">
                            <div class="legend-color empty"></div>
                            <span>空き</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color reserved"></div>
                            <span>予約あり</span>
                        </div>
                    </div>
                </div>
                <!-- 中央：タイトル＋F5ヒント＋ボタン群 -->
                <div class="header-center">
                    <div class="site-title">個別ブース予約管理ツール</div>
                    <div class="f5-hint">F5を押すと本日の予約画面に戻ります</div>
                    <div class="floor-and-tools">
                        <div class="floor-tabs">
                            <button class="floor-tab active" data-floor="6F">6F</button>
                            <button class="floor-tab" data-floor="7F">7F</button>
                        </div>
                        <button class="admin-btn" id="adminBtn">管理者</button>
                        <button class="preview-btn" id="previewBtn">プレビュー</button>
                    </div>
                </div>
                <!-- 右：空きスペース（バランス用） -->
                <div class="header-right"></div>
            </div>
        </header>

        <!-- プレビューモーダル -->
        <div id="previewModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>予約状況プレビュー</h2>
                    <span class="close-button" id="closePreviewModalBtn">&times;</span>
                </div>
                <div class="modal-body">
                    <div class="preview-controls">
                        <label for="previewDate">日付:</label>
                        <input type="date" id="previewDate">
                        <div class="preview-floor-tabs">
                            <button class="preview-floor-tab active" data-floor="6F">6F</button>
                            <button class="preview-floor-tab" data-floor="7F">7F</button>
                        </div>
                    </div>
                    <div class="preview-table-container">
                        <table class="preview-table" id="previewTable">
                            <thead>
                                <tr id="timeHeaderRow">
                                    <th>席番号</th>
                                </tr>
                            </thead>
                            <tbody id="previewTableBody">
                                <!-- 座席と予約情報がここに動的に挿入されます -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- 座席レイアウト -->
        <main class="main">
            <div class="seat-layout" id="seatLayout">
                <!-- 座席がJavaScriptで動的に生成されます -->
            </div>
        </main>

        <!-- 予約サイドパネル -->
        <div class="side-panel" id="sidePanel">
            <div class="panel-header">
                <h3 id="sidePanelTitle">予約登録</h3>
                <button class="close-btn" id="closeSidePanelBtn">×</button>
            </div>
            <div class="panel-body">
                <div class="form-group">
                    <label>席情報</label>
                    <div class="seat-info-display" id="seatInfoDisplay">
                        <span id="seatInfoText"></span>
                    </div>
                </div>
                <div class="form-group">
                    <label for="sideNameInput">名前 *</label>
                    <input type="text" id="sideNameInput" required>
                </div>
                <div class="form-group">
                    <label>コース *</label>
                    <div id="sideCourseSelectContainer" class="custom-select-container">
                        <input type="hidden" id="sideCourseSelect">
                        <!-- カスタムセレクトがJSで動的に生成されます -->
                    </div>
                </div>
                <div class="form-group">
                    <label>目的 *</label>
                    <div class="purpose-options">
                        <label><input type="radio" name="sidePurposeType" value="自習" checked> 自習</label>
                        <label><input type="radio" name="sidePurposeType" value="補講"> 補講</label>
                        <label><input type="radio" name="sidePurposeType" value="その他"> その他</label>
                    </div>
                    <textarea id="sideNoteTextarea" placeholder="準備物を記入" style="display: none;"></textarea>
                </div>
                <div class="form-group">
                    <label for="sideStartTimeSelect">開始時刻 *</label>
                    <select id="sideStartTimeSelect" required></select>
                </div>
                <div class="form-group">
                    <label for="sideEndTimeSelect">終了時刻 *</label>
                    <select id="sideEndTimeSelect" required></select>
                </div>
                <div class="form-group">
                    <button class="submit-btn" id="sideSubmitBtn">予約登録</button>
                </div>
            </div>
            <div class="panel-footer">
                <div class="reservations-list" id="reservationsList">
                    <h4>当日の予約一覧</h4>
                    <div id="reservationsListContent"></div>
                </div>
            </div>
        </div>
    </div>



    <!-- 管理者パネル -->
    <div class="modal" id="adminPanel">
        <div class="modal-content admin-panel-content">
            <div class="modal-header">
                <h3>管理者パネル</h3>
                <button class="close-btn" id="closeAdminBtn">×</button>
            </div>
            <div class="modal-body">
                <div class="admin-tabs">
                    <button class="admin-tab active" data-tab="bulk">一括確保</button>
                    <button class="admin-tab" data-tab="courses">コース管理</button>
                    <button class="admin-tab" data-tab="logs">ログ</button>
                </div>
                
                <!-- 一括確保タブ -->
                <div class="admin-tab-content active" id="bulkTab">
                    <div class="form-group">
                        <label for="adminDateSelect">日付</label>
                        <input type="date" id="adminDateSelect">
                    </div>
                    <div class="form-group">
                        <label for="adminFloorSelect">フロア</label>
                        <select id="adminFloorSelect">
                            <option value="6F">6F</option>
                            <option value="7F">7F</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>席選択</label>
                        <div class="seat-pick-container" id="seatPickContainer">
                            <!-- 席番号ボタンが動的に生成されます -->
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="adminStartTimeSelect">開始時刻</label>
                        <select id="adminStartTimeSelect"></select>
                    </div>
                    <div class="form-group">
                        <label for="adminEndTimeSelect">終了時刻</label>
                        <select id="adminEndTimeSelect"></select>
                    </div>
                    <div class="form-group">
                        <label for="adminNameInput">予約名 *</label>
                        <input type="text" id="adminNameInput" placeholder="例：○○講習" required>
                    </div>
                    <div class="form-group">
                        <label>コース</label>
                        <div id="adminCourseSelectContainer" class="custom-select-container">
                            <input type="hidden" id="adminCourseSelect">
                            <!-- カスタムセレクトがJSで動的に生成されます -->
                        </div>
                    </div>
                    <div class="form-group">
                        <label>目的</label>
                        <div class="purpose-options">
                            <label><input type="radio" name="adminPurposeType" value="自習" checked> 自習</label>
                            <label><input type="radio" name="adminPurposeType" value="補講"> 補講</label>
                            <label><input type="radio" name="adminPurposeType" value="その他"> その他</label>
                        </div>
                        <textarea id="adminNoteTextarea" placeholder="準備物を記入" style="display: none;"></textarea>
                    </div>
                    <button type="button" class="submit-btn" id="bulkReserveBtn">予約実行</button>
                    <div class="bulk-results" id="bulkResults"></div>
                    
                    <!-- 繰り返し設定 -->
                    <div class="recurring-checkbox-container">
                        <input type="checkbox" id="useRecurring">
                        <label for="useRecurring">繰り返し設定を使う</label>
                    </div>
                    
                    <div id="recurringOptions" class="recurring-settings" style="display:none;">
                        <div class="form-group">
                            <label for="recurringStartDate">開始日</label>
                            <input type="date" id="recurringStartDate">
                        </div>
                        <div class="form-group">
                            <label for="recurringEndDate">終了日</label>
                            <input type="date" id="recurringEndDate">
                        </div>
                        <div class="form-group">
                            <label>曜日</label>
                            <div class="weekday-checkboxes">
                                <label><input type="checkbox" name="weekday" value="0"> 日</label>
                                <label><input type="checkbox" name="weekday" value="1"> 月</label>
                                <label><input type="checkbox" name="weekday" value="2"> 火</label>
                                <label><input type="checkbox" name="weekday" value="3"> 水</label>
                                <label><input type="checkbox" name="weekday" value="4"> 木</label>
                                <label><input type="checkbox" name="weekday" value="5"> 金</label>
                                <label><input type="checkbox" name="weekday" value="6"> 土</label>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- コース管理タブ -->
                <div class="admin-tab-content" id="coursesTab">
                    <div class="courses-header">
                        <h4>コース一覧</h4>
                        <button class="add-btn" id="addCourseBtn">追加</button>
                    </div>
                    <div class="courses-list" id="coursesList">
                        <!-- コースリストが動的に生成されます -->
                    </div>
                </div>
                
                <!-- ログタブ -->
                <div class="admin-tab-content" id="logsTab">
                    <div class="logs-header">
                        <h4>一括予約ログ（最新50件）</h4>
                        <button class="refresh-btn" id="refreshLogsBtn">更新</button>
                    </div>
                    <div class="logs-list" id="logsList">
                        <!-- ログリストが動的に生成されます -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- トースト通知 -->
    <div class="toast" id="toast"></div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    
    <script src="firebase.js"></script>
    <script src="app.js"></script>
</body>
</html>
